{"board":"\n    <div id=\"board-list\" style=\"visibility: visible;\"><div class=\"board-itens\" id=\"board-item-0-New Board\"> \n                <label id=\"board-key-0-New Board\" onclick=\"loadBoard(boards[0], 'board-item-0-New Board')\">New Board</label>\n                <button class=\"boardDeleteButton\" onclick=\"deleteBoard(&quot;board-item-0-New Board&quot;, &quot;New Board&quot;)\">\n                    -\n                </button>\n            </div></div>\n    <div class=\"nav\">\n        <input id=\"boardTitle\" spellcheck=\"false\" maxlength=\"40\" contenteditable=\"true\">\n        <button class=\"save-button\" onclick=\"storeCurrentBoard()\">Salvar</button>\n        <button class=\"save-button\" onclick=\"toggleBoardVisibility()\">Board</button>\n    </div>\n    <div class=\"white-line\"></div> \n    <div class=\"columns\">\n        <div id=\"column_backlog\" class=\"column backlog\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\">\n            <h3>Backlog<button id=\"button_backlog\" onclick=\"addCard(&quot;column_backlog&quot;)\" class=\"add\"><strong>+</strong></button></h3>\n        </div>\n        <div id=\"column_todo\" class=\"column\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\">\n            <h3>To Do<button id=\"button_todo\" onclick=\"addCard(&quot;column_todo&quot;)\" class=\"add\"><strong>+</strong></button></h3>\n        </div>\n        <div id=\"column_progress\" class=\"column\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\">\n            <h3>In Progress<button id=\"button_progress\" onclick=\"addCard(&quot;column_progress&quot;)\" class=\"add\"><strong>+</strong></button></h3>\n        </div>\n        <div id=\"column_done\" class=\"column\" ondrop=\"drop(event)\" ondragover=\"allowDrop(event)\">\n            <h3>Done<button id=\"button_done\" onclick=\"addCard(&quot;column_done&quot;)\" class=\"add\"><strong>+</strong></button></h3>\n        </div>\n        <div id=\"column_deletar\" class=\"trash\" ondrop=\"dropDelete(event)\" ondragover=\"allowDrop(event)\">\n            <img src=\"./trash.png\" style=\"height: auto;\">\n            <div id=\"5\" class=\"dropzone\" draggable=\"true\" ondragstart=\"drag(event)\" ondrop=\"drop(event)\">\n            </div>\n        </div>\n    </div>\n\n<script>\n    let taskCounter = 0;\n    let boards = null;\n    let us_id_counter = 4;\n\n    function populateUsers()\n    {\n\n    }\n\n    function addCard(id)\n    {\n        us_id_counter++;\n        let str = `<div id=\"${us_id_counter}\" class=\"dropzone\" draggable=\"true\" ondragstart=\"drag(event)\" ondrop=\"drop(event)\">\n                <div class=\"card\" id=\"card-${us_id_counter}\"> \n                    <div class=\"first-line\">\n                        <div class=\"id\">${us_id_counter}</div>\n                        <div contentEditable=\"true\" class=\"content\">\n                            Nome da Feature\n                        </div>\n                    </div>\n                    <div class=\"second-line\">\n                        <select id=\"${us_id_counter}-points\" class=\"user\">\n                            <option value=\"Lucas\">Lucas</option>\n                            <option value=\"Willy\">Willy</option>\n                            <option value=\"Shin\">Shin</option>\n                            <option value=\"Giuliano\">Giuliano</option>\n                            <option value=\"selecione\" selected></option>\n                        </select>\n                        <select id=\"${us_id_counter}-time\" class=\"time\">\n                            <option value=\"1\">1</option>\n                            <option value=\"2\">2</option>\n                            <option value=\"3\">3</option>\n                            <option value=\"5\">5</option>\n                            <option value=\"8\">8</option>\n                        </select>\n                    </div>\n                    <div class=\"button-task-div\">\n                        <button class=\"button-task\" onclick='addTask(\"card-${us_id_counter}\")'><strong>+</strong></button>\n                    </div>    \n                </div>\n            </div>`\n\n        col = document.getElementById(id);\n        $(`#${id}`).append($.parseHTML(str))\n    }\n\n    function addTask(id) {\n        \n        taskCounter++;\n\n        let str = \n            `<div id=\"${id}-${taskCounter}\">\n                <input id=\"${id}-${taskCounter}-checkbox\" type=\"checkbox\"></input>\n                <input id=\"${id}-${taskCounter}-input\" class=\"input-task\" maxlength=\"25\"></input>\n                <button class=\"delete\" onclick='remove(\"${id}-${taskCounter}\")'><strong>-</strong></button>\n            </div>`\n\n        col = document.getElementById(id);\n        $(`#${id}`).append($.parseHTML(str))\n    }\n\n    function remove(id) {\n        \n        el = document.getElementById(id)\n        el.remove()\n    }\n    \n    // Gratos ao W3S e Mozilla\n    function allowDrop(ev) \n    {\n        ev.preventDefault();\n    }\n\n    function drag(ev) \n    {\n        ev.dataTransfer.setData(\"drop\", ev.target.id);\n    }\n\n    function drop(ev) \n    {\n        if(ev.target.className != \"column\")\n            return;\n\n        ev.preventDefault();\n        var data = ev.dataTransfer.getData(\"drop\");\n        ev.target.appendChild(document.getElementById(data));\n    }\n\n    function dropDelete(ev) \n    {\n        ev.preventDefault();\n        var data = ev.dataTransfer.getData(\"drop\");\n        el = document.getElementById(data)\n        el.remove()\n    }\n\n    function getBoardTitle()\n    {\n        return document.getElementById(\"boardTitle\").value\n    }\n\n    function setBoardTitle(title)\n    {\n        document.getElementById(\"boardTitle\").value = title\n    }\n\n    function loadBoard(board, id)\n    {\n        document.getElementById(\"body\").innerHTML = board.board\n        loadValues(board.objs)\n        us_id_counter = board.us_id_counter\n        setBoardTitle(board.key)\n        getBoards()\n    }\n\n    function getBoard()\n    {\n        return document.getElementById(\"body\").innerHTML\n    }\n\n    const STOREBOARD_URL = \"/storeboard\"\n    const GETBOARDS_URL  = \"/getboards\"\n    const DELBOARDS_URL  = \"/delboard\"\n\n    //Ex: storeBoard(getBoard(), \"main_board\")\n    async function storeBoard(board, key)\n    {\n        objs = getValues()\n\n        data = \n        {\n            board: board,\n            key: key,\n            objs: objs,\n            us_id_counter: us_id_counter\n        }\n\n        await postServer(STOREBOARD_URL, data)\n    }\n\n    async function deleteBoard(id, board_key)\n    {\n        remove(id)\n        await postServer(DELBOARDS_URL, {key: board_key})\n        getBoards()\n    }\n\n    function storeCurrentBoard() \n    {\n\n        let board = getBoard()\n        let title = getBoardTitle()\n        storeBoard(board, title)\n        getBoards()\n    } \n\n    async function getBoards()\n    {\n        toggleBoardVisibility(\"hidden\")\n        document.getElementById(\"board-list\").innerHTML = \"\";\n        let listBoards = document.getElementById(\"board-list\");\n        boards = await queryServer(GETBOARDS_URL);\n        \n        for (let i = 0; i < boards.length; i++) \n            listBoards.innerHTML += `<div class=\"board-itens\" id=\"board-item-${i}-${boards[i].key}\"> \n                <label id=\"board-key-${i}-${boards[i].key}\" onClick=\"loadBoard(boards[${i}], 'board-item-${i}-${boards[i].key}')\">${boards[i].key}</label>\n                <button class=\"boardDeleteButton\" class=\"delete\" onClick='deleteBoard(\"board-item-${i}-${boards[i].key}\", \"${boards[i].key}\")'>\n                    -\n                </button>\n            </div>`\n            \n        \n        // loadBoard(boards[0].board)\n    }\n    \n    function getValues()\n    {\n        let objs = $('*');\n\n        let obj_ids  = []\n        let obj_vals = []\n\n        for(let i = 0; i < objs.length; i++)\n        {\n            if((objs[i].id != \"\") && (objs[i].id != null) && (objs[i].id != undefined))\n            {\n                obj_ids.push(objs[i].id)\n                if(objs[i].id.includes(\"checkbox\"))\n                    obj_vals.push(objs[i].checked)\n                else\n                     obj_vals.push(objs[i].value)\n            }\n        }\n\n        data = \n        {\n            obj_ids: obj_ids,\n            obj_vals: obj_vals\n        }\n\n        return data\n    }\n\n    function loadValues(objs)\n    {\n        console.log(objs)\n        for(let i = 0; i < objs.obj_ids.length; i++)\n        {\n            if(objs.obj_ids[i].includes(\"checkbox\"))\n                document.getElementById(objs.obj_ids[i]).checked = objs.obj_vals[i]\n            else\n                document.getElementById(objs.obj_ids[i]).value = objs.obj_vals[i]\n \n        }\n    }\n\n    /////////////////////////////////////////////////////////////////////////////////////////////////////\n    // Conexao servidor\n\n    async function queryServer(url)\n    {\n        let response = await fetch(url);\n        data         = await response.json(); \n        return data;\n    };\n\n    async function postServer(url, data)\n    {\n        let options  = {method: 'POST', body: JSON.stringify(data), headers: {'Content-Type': 'application/json'}};\n        let response = await fetch(url, options);\n        data         = await response.json();\n        return data;\n    };\n\n    let saveButtonStatus = 1;\n\n    function toggleBoardVisibility(state) {\n\n        if (state == \"visible\" || (state === undefined && saveButtonStatus == 0)) {\n            document.getElementById(\"board-list\").style.visibility = \"visible\";\n            saveButtonStatus = 1;\n        } else if (state == \"hidden\" || (state === undefined && saveButtonStatus == 1))\n        {\n            document.getElementById(\"board-list\").style.visibility = \"hidden\";\n            saveButtonStatus = 0;\n        }\n    }\n\n    toggleBoardVisibility(\"hidden\")\n    getBoards()\n    setBoardTitle(\"New Board\")\n\n</script>\n","key":"LOLCODE 2022","objs":{"obj_ids":["body","board-list","board-item-0-New Board","board-key-0-New Board","boardTitle","column_backlog","button_backlog","column_todo","button_todo","column_progress","button_progress","column_done","button_done","column_deletar","5"],"obj_vals":[null,null,null,null,"LOLCODE 2022",null,"",null,"",null,"",null,"",null,null]},"us_id_counter":4}